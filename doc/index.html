<!DOCTYPE html>
<html lang="ja">
<head>
	<meta charset="UTF-8">
	<link rel="stylesheet" href="https://cdn.rawgit.com/andyferra/2554919/raw/10ce87fe71b23216e3075d5648b8b9e56f7758e1/github.css">
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.2.0/styles/default.min.css">
	
	
	<title>tchart-coffee</title>
</head>
<body>
<h1>tchart-coffee</h1><div id="toc"></div>

<h2>概要</h2>

<p>このようなテキストを入力すると、</p>

<pre><code class="nohighlight">aclk    ~_~_~_~_~_~_~_~_~_~_
awaddr  ==?X=A1==X=A2X=A3==X==?=X=A4X=?
awvalid __~~~~~~~~~~____~~__
awready ____[~~~~]__[~~]____[~~]__
wdata   ====?X=D1X=D2X=?X=D3X=?X=D4==X=?
wvalid  ____~~~~__~~__~~~~__
wready  ____~~~~__~~____~~__
bresp   ====00================
bvalid  ____~~~~__~~____~~__
bready  ~~~~~~~~~~~~~~~~~~1~~
</code></pre>

<p>こんなタイミングチャートを生成する javascript ライブラリとエディタを提供します。</p>

<pre><code class="tchart2svg">aclk    ~_~_~_~_~_~_~_~_~_~_
awaddr  ==?X=A1==X=A2X=A3==X==?=X=A4X=?
awvalid __~~~~~~~~~~____~~__
awready ____[~~~~]__[~~]____[~~]__
wdata   ====?X=D1X=D2X=?X=D3X=?X=D4==X=?
wvalid  ____~~~~__~~__~~~~__
wready  ____~~~~__~~____~~__
bresp   ====00================
bvalid  ____~~~~__~~____~~__
bready  ~~~~~~~~~~~~~~~~~~1~~
</code></pre>

<h2>ライブラリ</h2>

<p><a href="https://www.npmjs.com/package/tchart-coffee"><img src="https://nodei.co/npm/tchart-coffee.png?downloads=true&amp;downloadRank=true" alt="NPM"></a></p>

<h3>Use with Node.js</h3>

<pre><code>$ npm install tchart-coffee
</code></pre>

<pre><code class="javascript">var TimingChart = require(&#39;tchart-coffee&#39;);
var svg = TimingChart.format(source);
</code></pre>

<h3>Use on the Web</h3>

<pre><code class="javascript">&lt;script src=&quot;https://cdn.rawgit.com/osamutake/tchart-coffee/v1.1.0/lib/tchart-coffee.min.js&quot;&gt;&lt;/script&gt;
&lt;script&gt;
  var svg = TimingChart.format(source);
&lt;/script&gt;
</code></pre>

<h3>API</h3>

<p>未稿</p>

<h2>エディタ</h2>

<p>こちらからご利用いただけます。</p>

<p><a href="https://rawgit.com/osamutake/tchart-coffee/master/bin/editor-offline.html" target="_blank">https://rawgit.com/osamutake/tchart-coffee/master/bin/editor-offline.html</a></p>

<ul>
<li>清書したタイミングチャートを SVG または PNG 形式で保存できます。</li>
<li>入力内容はサーバーに送られることなく、完全にブラウザ上だけで画像を生成しますので、守秘義務の問題も発生しません。心配であればリンク先の html を PC に保存して、そこから立ち上げれば、完全にオフラインの状態でも動作します。</li>
</ul>

<h3>IE での不具合</h3>

<p><a href="https://connect.microsoft.com/IE/feedback/details/809823/draw-svg-image-on-canvas-context">リンク先で議論されている問題</a>のため、[Save as PNG] および [Generate Images for Copy] のボタンが IE では正常に働きません。</p>

<p>代わりに、SVG 画像上で右クリックから [名前を付けて画像を保存] で形式を PNG にすれば保存できます。
同様に、右クリックから [コピー] で画像をクリップボードへ入れられるので、 Word などへ貼り付ける用途ではむしろ IE の方が便利かもしれません。</p>

<h3>IE 以外でクリップボードへのコピーの仕方</h3>

<p>セキュリティ上の制限のため、javascript からクリップボードへ 自動的にコピーすることはできないようになっています。 そこで、手動で対応していただく必要があります。</p>

<p>まず [Generate Images for Copy] ボタンを押すと SVG ソースと PNG 画像が生成されます。</p>

<ul>
<li>SVG ソースをご入り用であれば、SVG ソースにフォーカスが当たっている状況でそのまま Ctrl+C すればコピー可能です</li>
<li>PNG 画像がご入り用であれば、PNG 画像上で右クリックから [画像をコピー] します

<ul>
<li>なぜか空の HTML も一緒にコピーされてしまうようで、なおかつこの空の HTML が優先的に貼り付けられるようなので、Word などへ貼り付ける際には [形式を選択して貼り付け]-[ビットマップ(DIB)] などとして下さい（Office でのショートカットは Alt+E,S です）</li>
</ul></li>
</ul>

<h2>チャート文法</h2>

<p><a href="syntax.html">こちらをご覧下さい</a></p>

<h2>謝辞</h2>

<p>熊谷正朗さんの &quot;Timing chart formatter by kumagai&quot; を大いに参考にさせていただきました。→
<a href="http://www.mech.tohoku-gakuin.ac.jp/rde/contents/library/tchart/indexframe.html">http://www.mech.tohoku-gakuin.ac.jp/rde/contents/library/tchart/indexframe.html</a></p>

<p>記述文法はほぼ熊谷さんの tchart を踏襲しています。</p>

<p>大変有用なツールをご提供くださったことに感謝いたします。</p>

</body>

<script src="https://rawgit.com/osamutake/tchart-coffee/master/lib/tchart.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.2.0/highlight.min.js"></script>
<script>
  hljs.configure({languages:[]})
	hljs.initHighlightingOnLoad();
</script>

<script>
// add toc
(function(){
	var toc = '';
	var id = [];
	var nodes = document.getElementsByTagName('*');
	for(var i=0; i<nodes.length; i++){
		if(!/^h[1234]$/i.exec(nodes[i].tagName))
			continue;
		var level = nodes[i].tagName[1];
		while(id.length<level) {
			id.push(0);
			toc += '<ul>'
		}
		while(id.length>level) {
			id.pop();
			toc += '</ul>'
		}
		id[level-1]++;
		var id_s = id.join('-');
		nodes[i].id = id_s;

		toc += '<li><a href="#'+id_s+'">'+nodes[i].innerHTML+'</a>';
	}
	while(id.length>0) {
		id.pop();
		toc += '</ul>'
	}
	document.getElementById('toc').innerHTML = toc;
})();
</script>

<script>
// format tcharts
(function(){
	var codes = document.getElementsByClassName('tchart2svg');
	for (var i = codes.length-1; i >= 0; i--){
		var code = codes[i];
		var svg = TimingChart.format(code.textContent);
		var div = document.createElement('div');
		div.className = 'tchart';
		div.innerHTML = svg;
		var pre = code.parentNode;
		pre.parentNode.replaceChild(div, pre);
	}
})();
</script>

</html>
